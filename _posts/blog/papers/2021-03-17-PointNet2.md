---
layout: post
bigtitle:  "PointNet++"
subtitle:   ": Deep Hierarchical Feature Learning on Point Sets in a Metric Space"
categories:
    - blog
    - papers
tags:
    - point-cloud
    - detection
comments: true
published: true
---



# PointNet++: Deep Hierarchical Feature Learning on Point Sets in a Metric Space

NIPS 2017 [paper](https://papers.nips.cc/paper/2017/file/d8bf84be3800d12f74d8b05e9b89836f-Paper.pdf)

## Abstract

Few prior works study deep learning on point sets.  
PointNet [20] is a pioneer in this direction.   
However, by design PointNet does not capture local structures induced by the metric space points live in, limiting its ability to recognize fine-grained patterns and generalizability to complex scenes.  

> point sets에 대한 deep learning을 연구하는 선행 연구는 거의 없다.  
PointNet[20]은 이 방향의 선구자이다.  
그러나 설계상 PointNet은 metric space points에 의해 유도된 local structures를 캡처하지 않으므로, fine-grained patterns과 generalizability를 complex scenes으로 인식하는 기능이 제한된다.

In this work, we introduce a hierarchical neural network that applies PointNet recursively on a nested partitioning of the input point set.  
By exploiting metric space distances, our network is able to learn local features with increasing contextual scales.  
With further observation that point sets are usually sampled with varying densities, which results in greatly decreased performance for networks trained on uniform densities, we propose novel set learning layers to adaptively combine features from multiple scales.

> 본 연구에서는 input point set의 중첩된 분할(nested partitioning)에 PointNet을 재귀적으로 적용하는 계층적 신경망(hierarchical neural network)을 소개한다.
metric space distances를 이용하여, 우리의 네트워크는 상황별 스케일(contextual scales)을 증가시키는 local features을 배울 수 있다.
point sets가 일반적으로 다양한 밀도(varying densities)로 샘플링되어 균일한 밀도(uniform densities)로 훈련된 networks의 성능이 크게 저하된다는 추가 관찰을 통해, 우리는 multiple scales의 features을 적응적으로 결합하기 위한 novel set learning layers을 제안한다.

Experiments show that our network called PointNet++ is able to learn deep point set features efficiently and robustly.  
In particular, results significantly better than state-of-the-art have been obtained on challenging benchmarks of 3D point clouds.

## 1 Introduction

<under>We are interested in analyzing geometric point sets which are collections of points in a Euclidean space.</under>  
A particularly important type of geometric point set is point cloud captured by 3D scanners, e.g., from appropriately equipped autonomous vehicles.  

> 우리는 Euclidean space의 points 집합인 geometric point sets을 분석하는 데 관심이 있다.  
특히 중요한 유형의 geometric point set는 3D 스캐너(예: 적절한 장비를 갖춘 자율 주행 차량)에 의해 포착된 point cloud이다.

<under>As a set, such data has to be invariant to permutations of its members.</under>  
<under>In addition, the distance metric defines local neighborhoods that may exhibit different properties.</under>  
For example, the density and other attributes of points may not be uniform across different locations — in 3D scanning the density variability can come from perspective effects, radial density variations, motion, etc.

> 집합으로서, 그러한 데이터는 구성원의 permutations에 invariant해야 한다.  
또한 distance metric은 다른 properties을 나타낼 수 있는 local neighborhoods을 정의한다.  
예를 들어, points의 밀도 및 기타 속성은 서로 다른 위치에 걸쳐 균일하지 않을 수 있다.  
3D 스캐닝에서 density variability은 원근 효과(perspective effects), 방사형 밀도 변화(radial density variations), motion 등에서 발생할 수 있다.




Few prior works study deep learning on point sets.  
PointNet [20] is a pioneering effort that directly processes point sets.  
<under>The basic idea of PointNet is to learn a spatial encoding of each point and then aggregate all individual point features to a global point cloud signature.</under>  
By its design, PointNet does not capture local structure induced by the metric.

> point sets에 대한 deep learning을 연구하는 선행 연구는 거의 없다.  
PointNet[20]은 point sets를 직접 처리하는 선구적인 노력이다.
PointNet의 기본 아이디어는 각 point의 공간 인코딩을 학습한 다음 모든 개별 point features을 global point cloud signature에 통합하는 것이다.
설계상 PointNet은 metric에 의해 유도된 local structure를 캡처하지 않는다.

<under>However, exploiting local structure has proven to be important for the success of convolutional architectures.</under>  
A CNN takes data defined on regular grids as the input and is able to progressively capture features at increasingly larger scales along a multi-resolution hierarchy.  
At lower levels neurons have smaller receptive fields whereas at higher levels they have larger receptive fields.  
The ability to abstract local patterns along the hierarchy allows better generalizability to unseen cases.

> 그러나 local structure를 활용하는 것이 convolutional architectures의 성공에 중요한 것으로 입증되었다.
CNN은 정규 그리드에 정의된 데이터를 입력으로 사용하고 multi-resolution hierarchy을 따라 점점 더 큰 scales로 features을 점진적으로 캡처할 수 있다.
lower levels에서 neurons은 더 작은 수용 영역(receptive fields)을 가지는 반면 higher levels에서 더 큰 수용 영역을 가진다.
hierarchy에 따라 local patterns을 추상화(abstract)하는 기능을 통해 보이지 않는 사례에 대한 generalizability를 개선할 수 있다.




<under>We introduce a hierarchical neural network, named as PointNet++, to process a set of points sampled in a metric space in a hierarchical fashion.</under>  
The general idea of PointNet++ is simple.  
<under>We first partition the set of points into overlapping local regions by the distance metric of the underlying space.</under>  

> metric space에서 샘플링된 points 집합을 계층적 방식(hierarchical fashion)으로 처리하기 위해 PointNet++라는 이름의 계층적 신경망을 도입한다.  
PointNet++의 일반적인 아이디어는 간단하다.  
먼저 기본 공간(underlying space)의 distance metric에 따라 points 집합을 overlapping하는 local regions으로 분할한다.

<under>Similar to CNNs, we extract local features capturing fine geometric structures from small neighborhoods; such local features are further grouped into larger units and processed to produce higher level features.  
This process is repeated until we obtain the features of the whole point set.</under>

> CNN과 유사하게, 우리는 small neighborhoods에서 fine geometric structures를 캡처하는 local features을 추출한다; 이러한 local features은 더 큰 단위로 그룹화되어 더 높은 수준의 features을 생성하기 위해 처리된다.  
이 프로세스는 전체 point set의 특징을 얻을 때까지 반복됩니다.



<under>The design of PointNet++ has to address two issues: how to generate the partitioning of the point set, and how to abstract sets of points or local features through a local feature learner.</under>  
The two issues are correlated because the partitioning of the point set has to produce common structures across partitions, so that weights of local feature learners can be shared, as in the convolutional setting.  

> PointNet++의 설계는 두 가지 문제를 해결해야 한다 : point set의 partitioning을 생성하는 방법과 local feature learner를 통해 points 집합 또는 local features을 추상화하는 방법.  
두 문제는 point set의 분할이 partitions 간에 공통 구조를 생성하여, convolutional setting에서처럼 local feature learners의 weights를 공유할 수 있기 때문에 상관관계가 있다.

We choose our local feature learner to be PointNet.  
As demonstrated in that work, <under>PointNet is an effective architecture to process an unordered set of points for semantic feature extraction.</under>  
In addition, this architecture is robust to input data corruption.  
As a basic building block, PointNet abstracts sets of local points or features into higher level representations.  
<under>In this view, PointNet++ applies PointNet recursively on a nested partitioning of the input set.</under>

> local feature learner를 PointNet으로 선택합니다.
그 연구에서 입증되었듯이, PointNet은 의미론적 특징 추출(semantic feature extraction)을 위해 unordered set of points을 처리하는 효과적인 아키텍처이다.
또한 이 아키텍처는 입력 데이터 손상에도 robust하다.  
기본 구성 block으로서, PointNet은 local points 또는 features 집합을 더 높은 수준의 representations으로 추상화한다.
this view에서, PointNet++는 입력 세트의 중첩된 분할(nested partitioning)에 반복적으로 PointNet을 적용합니다.

One issue that still remains is how to generate overlapping partitioning of a point set.  
Each partition is defined as a neighborhood ball in the underlying Euclidean space, whose parameters include centroid location and scale.  

> 여전히 남아 있는 문제 중 하나는 point set의 중첩 분할(overlapping partitioning)을 생성하는 방법이다.  
각 partition은 centroid location 와 scale를 포함하는 기본 유클리드 공간(underlying Euclidean space)에서 neighborhood ball으로 정의된다.

To evenly cover the whole set, the centroids are selected among input point set by a farthest point sampling (FPS) algorithm.   
Compared with volumetric CNNs that scan the space with fixed strides, our local receptive fields are dependent on both the input data and the metric, and thus more efficient and effective.

> 전체 set를 균일하게 커버하기 위해, 가장 먼 포인트 샘플링(FPS:farthest point sampling) algorithm에 의해 설정된 input point set 중에서 centroids를 선택합니다.   
고정된 stride로 공간을 스캔하는 volumetric CNNs과 비교하여, 우리의 local receptive fields는 input data와 metric 모두에 의존하며, 따라서 더 효율적이고 효과적이다

![Fig1](/assets/img/Blog/papers/PointNet++/Fig1.JPG)

Deciding the appropriate scale of local neighborhood balls, however, is a more challenging yet intriguing problem, due to the entanglement of feature scale and non-uniformity of input point set.  
We assume that the input point set may have variable density at different areas, which is quite common in real data such as Structure Sensor scanning [18] (see Fig. 1).  

Our input point set is thus very different from CNN inputs which can be viewed as data defined on regular grids with uniform constant density.  
In CNNs, the counterpart to local partition scale is the size of kernels.  
[25] shows that using smaller kernels helps to improve the ability of CNNs.  
Our experiments on point set data, however, give counter evidence to this rule.  
Small neighborhood may consist of too few points due to sampling deficiency, which might be insufficient to allow PointNets to capture patterns robustly.

A significant contribution of our paper is that PointNet++ leverages neighborhoods at multiple scales to achieve both robustness and detail capture.  
Assisted with random input dropout during training, the network learns to adaptively weight patterns detected at different scales and combine multi-scale features according to the input data.  
Experiments show that our PointNet++ is able to process point sets efficiently and robustly.  
In particular, results that are significantly better than state-of-the-art have been obtained on challenging benchmarks of 3D point clouds.

## 2 Problem Statement

Suppose that $$\mathcal{X} = (M,d)$$ is a discrete metric space whose metric is inherited from a Euclidean space
$$\mathbb{R}^n$$, where $$M \subseteq \mathbb{R}^n$$ is the set of points and $$d$$ is the distance metric.  
In addition, the density of $$M$$ in the ambient Euclidean space may not be uniform everywhere.  
We are interested in learning set functions $$f$$ that take such $$\mathcal{X}$$ as the input (along with additional features for each point) and produce information of semantic interest regrading $$\mathcal{X}$$.  
In practice, such $$f$$ can be classification function that assigns a label to $$\mathcal{X}$$ or a segmentation function that assigns a per point label to each member of $$M$$.

## 3 Method

Our work can be viewed as an extension of PointNet [20] with added hierarchical structure.  
We first review PointNet (Sec. 3.1) and then introduce a basic extension of PointNet with hierarchical structure (Sec. 3.2).  
Finally, we propose our PointNet++ that is able to robustly learn features even in non-uniformly sampled point sets (Sec. 3.3).
